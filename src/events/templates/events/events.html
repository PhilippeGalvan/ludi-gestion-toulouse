{% extends 'base.html' %}
{% load static %}

{% block title %}Ludi Gestion - Ev√®nements{% endblock %}

{% block content %}
<div>
    <link rel="stylesheet" href="{% static "css/events.css" %}" />
        {% for event in events %}
        <div class="event">
            <div>
                <p>{{ event.name }} le {{ event.date_french_format }}</p>
                <p>{{ event.description }}</p>
            </div>
            {% if user not in event.candidates %}
            <div>
                <form action="{% url 'events:register-member' event.pk%}" method="post">
                    {% csrf_token %}
                    {{ individual_candidacy_form.as_p }}
                    <input type="submit" value="Postuler">
                </form>
            {% else %}
                {% for candidacy in event.candidacies.all %}
                    {% if user in candidacy.candidates.all %}
                        <p>Candidature {{ forloop.counter }} : </p>
                        {% for candidate_wishes in candidacy.detailed_candidates.all %}
                            <p>Souhaits de : {{ candidate_wishes.candidate.username }}:
                            <p>En tant que joueur ?:
                                {% if candidate_wishes.player %}
                                    Oui
                                {% else %}
                                    Non
                                {% endif %}
                            </p>
                            <p>En tant que mc ?:
                                {% if candidate_wishes.speaker %}
                                    Oui
                                {% else %}
                                    Non
                                {% endif %}
                            </p>
                            <p>En tant que dj ?:
                                {% if candidate_wishes.disk_jockey %}
                                    Oui
                                {% else %}
                                    Non
                                {% endif %}
                            </p>
                            <p>En tant qu'arbitre ?:
                                {% if candidate_wishes.arbiter %}
                                    Oui
                                {% else %}
                                    Non
                                {% endif %}
                            </p>
                        {% endfor %}
                        <form action="{% url 'events:unregister-candidacy' event.pk candidacy.pk %}" method="post">
                            {% csrf_token %}
                            <button type="submit">
                                Annuler cette candidature
                            </button>
                        </form>
                    {% endif %}
                {% endfor %}
            {% endif %}
            </div>
        </div>
        {% endfor %}
</div>
{% endblock %}
